<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spyder2000 UI Mockup v2 - Rounded Corners + Authentic 7-Segment Display</title>

  <!-- Load authentic 7-segment display font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.cdnfonts.com/css/dseg7-classic" rel="stylesheet">

  <style>
    /* CRITICAL: WebView constraints - NO viewport units */
    html, body {
      height: 100%;  /* REQUIRED - replaces viewport units */
      margin: 0;
      padding: 0;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      /* Native application feel */
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      cursor: default;
      overflow: hidden;

      /* Centering for preview */
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
      font-family: Arial, sans-serif;
    }

    /* Fixed-size preview frame with rounded corners (test HTML only) */
    .plugin-frame {
      width: 450px;
      height: 300px;
      border: 2px solid #444;
      border-radius: 20px;  /* NEW: Rounded corners */
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      overflow: hidden;
      position: relative;
    }

    /* Plugin UI container with rounded corners */
    .container {
      width: 100%;
      height: 100%;
      position: relative;
      border-radius: 20px;  /* NEW: Rounded corners for stompbox feel */
      overflow: hidden;

      /* Ferrari Red glossy background */
      background: radial-gradient(
        ellipse at 50% 33%,
        #FF1744 0%,
        #DC143C 50%,
        #8B0000 100%
      );
    }

    /* Gloss overlay for shine effect */
    .gloss-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 50%;
      background: linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.3) 0%,
        rgba(255, 255, 255, 0.1) 50%,
        rgba(255, 255, 255, 0) 100%
      );
      pointer-events: none;
      border-radius: 20px 20px 0 0;  /* Match container corners */
    }

    /* Plugin name */
    .plugin-name {
      position: absolute;
      top: 25px;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'Arial Black', sans-serif;
      font-size: 24px;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      letter-spacing: 3px;
    }

    /* Knob container */
    .knob-container {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    /* Knob body (rotates as whole unit) */
    .knob {
      width: 80px;
      height: 80px;
      position: relative;
      cursor: pointer;
      transform-origin: center center;
      transition: transform 50ms;
    }

    /* Knob background circle */
    .knob-bg {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #2a2a2a;
      box-shadow:
        inset -3px -3px 8px rgba(0, 0, 0, 0.7),
        inset 3px 3px 8px rgba(100, 100, 100, 0.3),
        0 4px 8px rgba(0, 0, 0, 0.5);
      position: relative;
    }

    /* POD-style rubber texture */
    .knob-texture {
      position: absolute;
      width: 70%;
      height: 70%;
      top: 15%;
      left: 15%;
      border-radius: 50%;
      background: repeating-conic-gradient(
        from 0deg,
        #1a1a1a 0deg 2deg,
        #333333 2deg 4deg
      );
    }

    /* Knob indicator line (rotates with knob) */
    .knob-indicator {
      position: absolute;
      width: 3px;
      height: 25px;
      background: #ffffff;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 2px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    /* Knob label */
    .knob-label {
      font-size: 14px;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
      letter-spacing: 1px;
    }

    /* Authentic 7-segment display (NEW v2 styling) */
    .seven-segment-display {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 140px;
      height: 40px;
      background: #000000;  /* NEW: Pure black background like clock radio */
      border: 2px solid #333;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;

      /* NEW: Authentic 7-segment LED font */
      font-family: 'DSEG7 Classic', 'Digital-7', 'Segment7', 'Courier New', monospace;
      font-size: 22px;
      font-weight: bold;
      color: #FF3333;  /* NEW: Bright glowing red */

      /* NEW: Multiple text-shadow layers for authentic LED glow effect */
      text-shadow:
        0 0 5px #ff0000,
        0 0 10px #ff0000,
        0 0 15px #ff0000,
        0 0 20px #ff3333,
        0 0 30px #ff3333;

      letter-spacing: 3px;
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
    }

    /* Debug monitor (test HTML only) */
    .debug-monitor {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.85);
      color: #0f0;
      font-family: 'Courier New', monospace;
      font-size: 11px;
      padding: 8px 12px;
      border: 1px solid #333;
      border-radius: 4px;
      min-width: 150px;
      pointer-events: none;
      z-index: 10000;
    }

    .debug-label {
      color: #666;
      font-size: 9px;
      margin-bottom: 4px;
      letter-spacing: 1px;
    }

    .debug-param {
      font-weight: bold;
      color: #0f0;
    }

    .debug-value {
      color: #fff;
      margin-top: 2px;
    }

    .debug-normalized {
      color: #888;
      font-size: 10px;
    }
  </style>
</head>
<body>
  <!-- Fixed-size plugin frame with rounded corners (450×300) -->
  <div class="plugin-frame">
    <div class="container">
      <!-- Gloss overlay for shine -->
      <div class="gloss-overlay"></div>

      <!-- Plugin name -->
      <div class="plugin-name">SPYDER 2000</div>

      <!-- Gain knob -->
      <div class="knob-container" style="left: 65px; top: 80px;">
        <div class="knob" id="gain-knob" data-param="gain" data-value="5.0" data-min="0" data-max="10">
          <div class="knob-bg">
            <div class="knob-texture"></div>
            <div class="knob-indicator"></div>
          </div>
        </div>
        <div class="knob-label">GAIN</div>
      </div>

      <!-- Tone knob -->
      <div class="knob-container" style="left: 185px; top: 80px;">
        <div class="knob" id="tone-knob" data-param="tone" data-value="5.0" data-min="0" data-max="10">
          <div class="knob-bg">
            <div class="knob-texture"></div>
            <div class="knob-indicator"></div>
          </div>
        </div>
        <div class="knob-label">TONE</div>
      </div>

      <!-- Level knob -->
      <div class="knob-container" style="left: 305px; top: 80px;">
        <div class="knob" id="level-knob" data-param="level" data-value="8.0" data-min="0" data-max="10">
          <div class="knob-bg">
            <div class="knob-texture"></div>
            <div class="knob-indicator"></div>
          </div>
        </div>
        <div class="knob-label">LEVEL</div>
      </div>

      <!-- Authentic 7-segment display (NEW v2) -->
      <div class="seven-segment-display" id="display">INSANE</div>
    </div>
  </div>

  <!-- Debug parameter monitor -->
  <div class="debug-monitor">
    <div class="debug-label">PARAMETER MONITOR</div>
    <div class="debug-param" id="debugParam">—</div>
    <div class="debug-value" id="debugValue">—</div>
    <div class="debug-normalized" id="debugNormalized">—</div>
  </div>

  <script>
    // Mock JUCE backend for browser testing
    window.Juce = {
      getSliderState: (id) => ({
        normalisedValue: 0.5,
        valueChangedEvent: {
          addListener: (fn) => console.log(`Listener added for ${id}`)
        },
        setNormalisedValue: (value) => {
          console.log(`${id} set to ${value}`);
        }
      })
    };

    // Disable context menu (REQUIRED)
    document.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      return false;
    });

    // Disable default drag behaviors
    document.addEventListener("dragstart", (e) => {
      e.preventDefault();
    });

    // Knob interaction state
    let activeKnob = null;
    let startY = 0;
    let startValue = 0;
    let displayTimeout = null;

    // Initialize knobs
    const knobs = document.querySelectorAll('.knob');
    knobs.forEach(knob => {
      const value = parseFloat(knob.dataset.value);
      const min = parseFloat(knob.dataset.min);
      const max = parseFloat(knob.dataset.max);
      updateKnobRotation(knob, value, min, max);
    });

    // Mouse down - start dragging
    document.addEventListener('mousedown', (e) => {
      const knob = e.target.closest('.knob');
      if (!knob) return;

      activeKnob = knob;
      startY = e.clientY;
      startValue = parseFloat(knob.dataset.value);
      e.preventDefault();
    });

    // Mouse move - update knob value
    document.addEventListener('mousemove', (e) => {
      if (!activeKnob) return;

      const deltaY = startY - e.clientY;  // Inverted: up = increase
      const min = parseFloat(activeKnob.dataset.min);
      const max = parseFloat(activeKnob.dataset.max);
      const range = max - min;

      // 200px drag = full range
      const sensitivity = range / 200;
      let newValue = startValue + (deltaY * sensitivity);

      // Clamp to range
      newValue = Math.max(min, Math.min(max, newValue));

      // Update knob
      activeKnob.dataset.value = newValue.toFixed(1);
      updateKnobRotation(activeKnob, newValue, min, max);

      // Update display
      const paramId = activeKnob.dataset.param.toUpperCase();
      const display = document.getElementById('display');
      display.textContent = `${paramId} ${newValue.toFixed(1)}`;

      // Update debug monitor
      updateDebugMonitor(paramId, newValue, (newValue - min) / range);

      // Reset display timeout
      clearTimeout(displayTimeout);
      displayTimeout = setTimeout(() => {
        display.textContent = 'INSANE';
        document.getElementById('debugParam').textContent = '—';
        document.getElementById('debugValue').textContent = '—';
        document.getElementById('debugNormalized').textContent = '—';
      }, 2000);

      e.preventDefault();
    });

    // Mouse up - stop dragging
    document.addEventListener('mouseup', () => {
      activeKnob = null;
    });

    // Update knob rotation
    function updateKnobRotation(knob, value, min, max) {
      const normalized = (value - min) / (max - min);  // 0 to 1
      const degrees = -135 + (normalized * 270);       // -135° to +135°
      knob.style.transform = `rotate(${degrees}deg)`;
    }

    // Update debug monitor
    function updateDebugMonitor(paramId, value, normalizedValue) {
      document.getElementById('debugParam').textContent = paramId;
      document.getElementById('debugValue').textContent = value.toFixed(1);
      document.getElementById('debugNormalized').textContent = `${(normalizedValue * 100).toFixed(1)}%`;
    }

    console.log('Spyder2000 UI Mockup v2 loaded');
    console.log('NEW v2 features: Rounded corners + Authentic 7-segment display');
    console.log('Controls: 3 knobs (gain, tone, level)');
    console.log('Drag knobs vertically to adjust values');
    console.log('Display shows "INSANE" when idle, parameter values when adjusting');
  </script>
</body>
</html>
